# Show available recipes
default:
    @just --list

# Build Debian package using standard Debian tools
build:
    #!/usr/bin/env bash
    set -e
    PROJECT_ROOT="{{justfile_directory()}}/.."

    # Build package (outputs to parent directory by default)
    cd "${PROJECT_ROOT}"
    dpkg-buildpackage -us -uc -b -d

    # Create dist directory and move artifacts
    mkdir -p "${PROJECT_ROOT}/dist"
    mv ../*.deb ../*.ddeb ../*.buildinfo ../*.changes "${PROJECT_ROOT}/dist/" 2>/dev/null || true

    echo "âœ“ Debian packages built in dist/"
    ls -lh "${PROJECT_ROOT}/dist/"

# Remove built Debian packages and build artifacts
clean:
    #!/usr/bin/env bash
    set -e
    PROJECT_ROOT="{{justfile_directory()}}/.."

    # Remove dist/ directory
    rm -rf "${PROJECT_ROOT}"/dist

    # Remove build artifacts in debian/ (staging uses package name with hyphen)
    rm -rf "${PROJECT_ROOT}"/debian/.debhelper "${PROJECT_ROOT}"/debian/debhelper-build-stamp
    rm -f "${PROJECT_ROOT}"/debian/files "${PROJECT_ROOT}"/debian/*.substvars
    rm -rf "${PROJECT_ROOT}"/debian/play-launch "${PROJECT_ROOT}"/debian/play-launch-dbgsym
    rm -rf "${PROJECT_ROOT}"/debian/home
